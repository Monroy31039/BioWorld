"0","# 2. Ordenamos por Localidad y un índice para recorrido"
"0","calle2 <- calle_filtrada %>% "
"0","  mutate(.idx = row_number()) %>% "
"0","  arrange(Localidad, .idx)"
"0",""
"0","# 3. Preparamos vector auxiliar de muestra"
"0","muestra2 <- calle2$muestra"
"0",""
"0","# 4. Reemplazo hasta 3 filas hacia adelante dentro de cada localidad"
"0","for (loc in unique(calle2$Localidad)) {"
"0","  idx_loc <- which(calle2$Localidad == loc)"
"0","  "
"0","  for (i in idx_loc) {"
"0","    # Solo si fue seleccionado y es Observación"
"0","    if (muestra2[i] == 1 && calle2$Recolección[i] == ""Observación"") {"
"0","      t <- 0"
"0","      j <- i + 1"
"0","      "
"0","      # Intentar reemplazar hasta 3 saltos adelante"
"0","      while (t < 3 && j %in% idx_loc) {"
"0","        if (muestra2[j] == 0 && calle2$Recolección[j] == ""Entrevista"") {"
"0","          # Reemplazo exitoso: movemos el 1 al entrevistado"
"0","          muestra2[i] <- 0"
"0","          muestra2[j] <- 1"
"0","          break"
"0","        }"
"0","        t <- t + 1"
"0","        j <- j + 1"
"0","      }"
"0","      # Si no encontró 'Entrevista' en 3 saltos, dejamos muestra2[i] == 1"
"0","    }"
"0","  }"
"0","}"
