"0","library(tidyverse)"
"0","library(performance)     # diagn칩stico y supuestos (easystats)"
"0","library(broom)           # tidy/augment/glance"
"0","library(broom.helpers)   # etiquetas, exponentiate handy"
"0","library(MASS)            # glm.nb"
"0","library(DHARMa)          # residuos simulados"
"0","library(dplyr)"
"0","set.seed(2025)"
"0",""
"0","# ==========================="
"0","# 1) Simulaci칩n + limpieza"
"0","# ==========================="
"0","n <- 300"
"0",""
"0","datos <- tibble("
"0","  sexo        = sample(c(""Hombre"", ""Mujer""), n, replace = TRUE),"
"0","  grupo_edad  = sample(c(""Joven"", ""Media"", ""Mayor""), n, replace = TRUE),"
"0","  educacion   = sample(c(""B치sica"", ""Media"", ""Superior""), n, replace = TRUE)"
"0",") %>%"
"0","  mutate("
"0","    sexo       = forcats::fct_relevel(factor(sexo), ""Hombre""),"
"0","    grupo_edad = forcats::fct_relevel(factor(grupo_edad), ""Joven""),"
"0","    educacion  = forcats::fct_relevel(factor(educacion), ""B치sica""),"
"0","    lambda = exp("
"0","      0.7 +"
"0","        0.3 * (sexo == ""Mujer"") +"
"0","        0.5 * (grupo_edad == ""Media"") +"
"0","        0.8 * (grupo_edad == ""Mayor"") +"
"0","        0.4 * (educacion == ""Media"") +"
"0","        0.6 * (educacion == ""Superior"")"
"0","    ),"
"0","    conteo = rpois(n, lambda)"
"0","  )"
"0","# ==========================="
"0","# 2) Modelos GLM (Poisson / Quasi)"
"0","# ==========================="
"0","modelo_pois <- glm("
"0","  conteo ~ sexo + grupo_edad + educacion,"
"0","  family = poisson(link = ""log""),"
"0","  data = datos"
"0",")"
"0",""
"0","modelo_qpois <- glm("
"0","  conteo ~ sexo + grupo_edad + educacion,"
"0","  family = quasipoisson(link = ""log""),"
"0","  data = datos"
"0",")"
"0",""
"0","# Coeficientes como razones de tasas (RR) con IC"
"0","rr_pois <- tidy(modelo_pois, conf.int = TRUE, exponentiate = TRUE) %>%"
"0","  mutate(across(c(estimate, conf.low, conf.high), ~round(.x, 3)))"
"0",""
"0","rr_qpois <- tidy(modelo_qpois, conf.int = TRUE, exponentiate = TRUE) %>%"
"0","  mutate(across(c(estimate, conf.low, conf.high), ~round(.x, 3)))"
"0",""
"0","rr_pois"
